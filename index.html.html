
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÛŒØ³ØªÙ… Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        @font-face {
            font-family: 'IranNastaliq';
            src: url('https://cdn.jsdelivr.net/gh/rastikerdar/iranianfonts@master/fonts/IranNastaliq/IranNastaliq.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f8f7f1;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23dbd1b3' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
        }
        
        .nastaliq {
            font-family: 'IranNastaliq', serif;
        }
        
        .persian-pattern {
            background-color: #f8f7f1;
            background-image: url("data:image/svg+xml,%3Csvg width='42' height='44' viewBox='0 0 42 44' xmlns='http://www.w3.org/2000/svg'%3E%3Cg id='Page-1' fill='none' fill-rule='evenodd'%3E%3Cg id='brick-wall' fill='%23b3a683' fill-opacity='0.1'%3E%3Cpath d='M0 0h42v44H0V0zm1 1h40v20H1V1zM0 23h20v20H0V23zm22 0h20v20H22V23z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        .btn-primary {
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .table-row-animate {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-active {
            border-bottom: 3px solid #1e40af;
            color: #1e40af;
            font-weight: 600;
        }
        
        .persian-card {
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            border: 1px solid #e5e0d5;
        }
        
        .persian-header {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            border-radius: 15px 15px 0 0;
            padding: 1.5rem;
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .persian-header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5z' fill='%23ffffff' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.3;
        }
        
        .persian-table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            border-radius: 0 0 15px 15px;
            overflow: hidden;
        }
        
        .persian-table thead {
            background: linear-gradient(90deg, #1e40af 0%, #3b82f6 100%);
            color: white;
        }
        
        .persian-table th {
            padding: 1rem;
            text-align: right;
            font-weight: 600;
        }
        
        .persian-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e5e0d5;
        }
        
        .persian-table tbody tr:nth-child(even) {
            background-color: #f8f7f1;
        }
        
        .persian-table tbody tr:hover {
            background-color: #f0ebdf;
        }
        
        .persian-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .persian-input {
            border: 2px solid #e5e0d5;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
        }
        
        .persian-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        
        .persian-button {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .persian-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .persian-button:active {
            transform: translateY(0);
        }
        
        .persian-button::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, transparent 0%, rgba(255, 255, 255, 0.2) 50%, transparent 100%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        .persian-button:hover::after {
            transform: translateX(100%);
        }
        
        .persian-modal {
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            border: 1px solid #e5e0d5;
        }
        
        .persian-modal-header {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            border-radius: 15px 15px 0 0;
            padding: 1rem 1.5rem;
            color: white;
        }
        
        .persian-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-success {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .badge-neutral {
            background-color: #e5e7eb;
            color: #374151;
        }
        
        .clock-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
            color: #4b5563;
        }
        
        .clock-segment {
            background-color: #f3f4f6;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: 600;
        }
        
        .clock-divider {
            font-weight: bold;
        }
        
        .export-button {
            background: linear-gradient(135deg, #10b981 0%, #047857 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .export-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .export-button:active {
            transform: translateY(0);
        }
        
        .export-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .export-dropdown-content {
            display: none;
            position: absolute;
            left: 0;
            top: 100%;
            background-color: white;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .export-dropdown:hover .export-dropdown-content {
            display: block;
        }
        
        .export-option {
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            color: #333;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .export-option:hover {
            background-color: #f0f9ff;
        }
        
        .export-icon {
            margin-left: 8px;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ùˆ ØªØ§Ø±ÛŒØ® Ùˆ Ø³Ø§Ø¹Øª -->
        <div class="persian-card mb-8">
            <div class="persian-header">
                <h1 class="nastaliq text-4xl mb-4">Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø±Ø­ÛŒÙ…</h1>
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div id="persianDate" class="text-lg mb-2 md:mb-0"></div>
                    <div id="clock" class="clock-container"></div>
                </div>
            </div>
            
            <div class="p-6">
                <h2 class="text-3xl font-bold text-center text-blue-800 mb-6">Ø³ÛŒØ³ØªÙ… Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†</h2>
                
                <!-- ØªØ¨â€ŒÙ‡Ø§ -->
                <div class="flex border-b mb-6">
                    <button id="attendanceTabBtn" class="px-4 py-2 tab-active">Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨</button>
                    <button id="employeesTabBtn" class="px-4 py-2">Ù„ÛŒØ³Øª Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†</button>
                </div>
                
                <!-- Ø¨Ø®Ø´ Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨ -->
                <div id="attendanceTab">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-8">
                        <div class="w-full md:w-2/3 bg-blue-50 p-4 rounded-lg border border-blue-100">
                            <div class="flex flex-col md:flex-row gap-4">
                                <div class="flex-grow">
                                    <label for="employeeCode" class="block text-sm font-medium text-gray-700 mb-1">Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ:</label>
                                    <input type="text" id="employeeCode" class="persian-input w-full" placeholder="Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                                </div>
                                <div class="flex gap-2 mt-4 md:mt-0">
                                    <button id="checkInBtn" class="persian-button bg-green-600 hover:bg-green-700 flex items-center justify-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
                                        </svg>
                                        Ø«Ø¨Øª ÙˆØ±ÙˆØ¯
                                    </button>
                                    <button id="checkOutBtn" class="persian-button bg-red-600 hover:bg-red-700 flex items-center justify-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd" />
                                        </svg>
                                        Ø«Ø¨Øª Ø®Ø±ÙˆØ¬
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ù…Ù†Ø¯ -->
                            <div id="employeeInfo" class="mt-4 p-3 bg-white rounded-md border border-blue-200 hidden">
                                <h3 class="font-bold text-blue-800 mb-2">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ù…Ù†Ø¯:</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                    <div>
                                        <span class="text-gray-600">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ:</span>
                                        <span id="infoFullName" class="font-medium mr-1"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">Ø³Ù…Øª:</span>
                                        <span id="infoPosition" class="font-medium mr-1"></span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600">Ø¨Ø®Ø´:</span>
                                        <span id="infoDepartment" class="font-medium mr-1"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex flex-col md:flex-row gap-2">
                            <button id="registerBtn" class="persian-button w-full md:w-auto flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z" />
                                </svg>
                                Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¬Ø¯ÛŒØ¯
                            </button>
                            
                            <div class="export-dropdown">
                                <button class="export-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                    </svg>
                                    Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ†
                                </button>
                                <div class="export-dropdown-content">
                                    <a id="exportAttendanceJson" class="export-option">
                                        <div class="flex items-center">
                                            <span class="export-icon">ğŸ“„</span>
                                            Ø®Ø±ÙˆØ¬ÛŒ JSON Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨
                                        </div>
                                    </a>
                                    <a id="exportAttendanceExcel" class="export-option">
                                        <div class="flex items-center">
                                            <span class="export-icon">ğŸ“Š</span>
                                            Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„ Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨
                                        </div>
                                    </a>
                                    <a id="exportEmployeesJson" class="export-option">
                                        <div class="flex items-center">
                                            <span class="export-icon">ğŸ“„</span>
                                            Ø®Ø±ÙˆØ¬ÛŒ JSON Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†
                                        </div>
                                    </a>
                                    <a id="exportEmployeesExcel" class="export-option">
                                        <div class="flex items-center">
                                            <span class="export-icon">ğŸ“Š</span>
                                            Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="persian-table">
                            <thead>
                                <tr>
                                    <th class="text-center">Ø±Ø¯ÛŒÙ</th>
                                    <th>Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</th>
                                    <th>Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</th>
                                    <th>ØªØ§Ø±ÛŒØ®</th>
                                    <th>Ø²Ù…Ø§Ù† ÙˆØ±ÙˆØ¯</th>
                                    <th>Ø²Ù…Ø§Ù† Ø®Ø±ÙˆØ¬</th>
                                    <th>Ù…Ø¯Øª Ø­Ø¶ÙˆØ±</th>
                                    <th>ÙˆØ¶Ø¹ÛŒØª</th>
                                </tr>
                            </thead>
                            <tbody id="attendanceTable">
                                <!-- Ø¬Ø¯ÙˆÙ„ Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨ Ø§ÛŒÙ†Ø¬Ø§ Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Ø¨Ø®Ø´ Ù„ÛŒØ³Øª Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù† -->
                <div id="employeesTab" class="hidden">
                    <div class="mb-6 flex justify-between">
                        <div class="export-dropdown">
                            <button class="export-button">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                                Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ†
                            </button>
                            <div class="export-dropdown-content">
                                <a id="exportEmployeesJsonTab" class="export-option">
                                    <div class="flex items-center">
                                        <span class="export-icon">ğŸ“„</span>
                                        Ø®Ø±ÙˆØ¬ÛŒ JSON Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†
                                    </div>
                                </a>
                                <a id="exportEmployeesExcelTab" class="export-option">
                                    <div class="flex items-center">
                                        <span class="export-icon">ğŸ“Š</span>
                                        Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†
                                    </div>
                                </a>
                            </div>
                        </div>
                        
                        <button id="registerBtnTab" class="persian-button flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z" />
                            </svg>
                            Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¬Ø¯ÛŒØ¯
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="persian-table">
                            <thead>
                                <tr>
                                    <th class="text-center">Ø±Ø¯ÛŒÙ</th>
                                    <th>Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</th>
                                    <th>Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</th>
                                    <th>Ø³Ù…Øª</th>
                                    <th>Ø¨Ø®Ø´</th>
                                    <th>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª Ù†Ø§Ù…</th>
                                    <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="employeesTable">
                                <!-- Ø¬Ø¯ÙˆÙ„ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù† Ø§ÛŒÙ†Ø¬Ø§ Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù…Ø¯Ø§Ù„ Ø«Ø¨Øª Ù†Ø§Ù… -->
    <div id="registerModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="persian-modal w-full max-w-md mx-4">
            <div class="persian-modal-header flex justify-between items-center">
                <h2 class="text-xl font-bold">Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¬Ø¯ÛŒØ¯</h2>
                <button id="closeRegisterModal" class="text-white hover:text-gray-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <div class="p-6 space-y-4">
                <div>
                    <label for="employeeCodeInput" class="block text-sm font-medium text-gray-700 mb-1">Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ:</label>
                    <input type="text" id="employeeCodeInput" class="persian-input w-full" placeholder="Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                    <p class="text-xs text-gray-500 mt-1">Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ 4 Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯</p>
                </div>
                
                <div>
                    <label for="fullName" class="block text-sm font-medium text-gray-700 mb-1">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ:</label>
                    <input type="text" id="fullName" class="persian-input w-full" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>
                
                <div>
                    <label for="position" class="block text-sm font-medium text-gray-700 mb-1">Ø³Ù…Øª:</label>
                    <input type="text" id="position" class="persian-input w-full" placeholder="Ø³Ù…Øª Ø´ØºÙ„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>
                
                <div>
                    <label for="department" class="block text-sm font-medium text-gray-700 mb-1">Ø¨Ø®Ø´:</label>
                    <select id="department" class="persian-input w-full">
                        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                        <option value="Ù…Ø¯ÛŒØ±ÛŒØª">Ù…Ø¯ÛŒØ±ÛŒØª</option>
                        <option value="Ù…Ù†Ø§Ø¨Ø¹ Ø§Ù†Ø³Ø§Ù†ÛŒ">Ù…Ù†Ø§Ø¨Ø¹ Ø§Ù†Ø³Ø§Ù†ÛŒ</option>
                        <option value="Ù…Ø§Ù„ÛŒ">Ù…Ø§Ù„ÛŒ</option>
                        <option value="ÙÙ†ÛŒ">ÙÙ†ÛŒ</option>
                        <option value="Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ">Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ</option>
                        <option value="ÙØ±ÙˆØ´">ÙØ±ÙˆØ´</option>
                        <option value="Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</option>
                        <option value="Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡">Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡</option>
                    </select>
                </div>
                
                <div class="flex justify-end">
                    <button id="saveEmployeeBtn" class="persian-button">
                        Ø«Ø¨Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ØªØ§Ø¨Ø¹ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ
        function toJalali(gy, gm, gd) {
            var g_d_m = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
            var jy = (gy <= 1600) ? 0 : 979;
            gy -= (gy <= 1600) ? 621 : 1600;
            var gy2 = (gm > 2) ? (gy + 1) : gy;
            var days = (365 * gy) + (parseInt((gy2 + 3) / 4)) - (parseInt((gy2 + 99) / 100)) + (parseInt((gy2 + 399) / 400)) - 80 + gd + g_d_m[gm - 1];
            jy += 33 * (parseInt(days / 12053));
            days %= 12053;
            jy += 4 * (parseInt(days / 1461));
            days %= 1461;
            jy += parseInt((days - 1) / 365);
            if (days > 365) days = (days - 1) % 365;
            var jm = (days < 186) ? 1 + parseInt(days / 31) : 7 + parseInt((days - 186) / 30);
            var jd = 1 + ((days < 186) ? (days % 31) : ((days - 186) % 30));
            return [jy, jm, jd];
        }
        
        // Ù†Ø§Ù… Ù…Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø³ÛŒ
        const jalaliMonths = [
            'ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±',
            'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'
        ];
        
        // Ù†Ø§Ù… Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù‡ÙØªÙ‡
        const jalaliWeekdays = [
            'ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡', 'Ø´Ù†Ø¨Ù‡'
        ];
        
        // ØªØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ
        function showPersianDate() {
            const now = new Date();
            const [jYear, jMonth, jDay] = toJalali(now.getFullYear(), now.getMonth() + 1, now.getDate());
            const weekday = jalaliWeekdays[now.getDay()];
            const monthName = jalaliMonths[jMonth - 1];
            
            document.getElementById('persianDate').textContent = `${weekday}ØŒ ${jDay} ${monthName} ${jYear}`;
        }
        
        // ØªØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´ Ø³Ø§Ø¹Øª
        function showClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            
            document.getElementById('clock').innerHTML = `
                <div class="clock-segment">${hours}</div>
                <div class="clock-divider">:</div>
                <div class="clock-segment">${minutes}</div>
                <div class="clock-divider">:</div>
                <div class="clock-segment">${seconds}</div>
            `;
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ§Ø±ÛŒØ® Ùˆ Ø³Ø§Ø¹Øª
        showPersianDate();
        showClock();
        setInterval(showClock, 1000);
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± localStorage
        let employees = JSON.parse(localStorage.getItem('employees')) || {};
        let attendance = JSON.parse(localStorage.getItem('attendance')) || [];
        
        // ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´
        function formatJalaliDate(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            const [jYear, jMonth, jDay] = toJalali(date.getFullYear(), date.getMonth() + 1, date.getDate());
            return `${jYear}/${jMonth.toString().padStart(2, '0')}/${jDay.toString().padStart(2, '0')}`;
        }
        
        // ØªØ¨Ø¯ÛŒÙ„ Ø²Ù…Ø§Ù† Ø¨Ù‡ ÙØ±Ù…Øª Ù…Ù†Ø§Ø³Ø¨
        function formatTime(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return date.toLocaleTimeString('fa-IR', { hour: '2-digit', minute: '2-digit' });
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ø¬Ø¯ÙˆÙ„ Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨
        function renderAttendanceTable() {
            const tableBody = document.getElementById('attendanceTable');
            tableBody.innerHTML = '';
            
            if (attendance.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `<td colspan="8" class="py-4 text-center text-gray-500">Ù‡ÛŒÚ† Ø±Ú©ÙˆØ±Ø¯ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</td>`;
                tableBody.appendChild(emptyRow);
                return;
            }
            
            attendance.forEach((record, index) => {
                const employee = employees[record.employeeCode] || { fullName: 'Ù†Ø§Ù…Ø´Ø®Øµ' };
                const row = document.createElement('tr');
                row.className = 'table-row-animate hover:bg-blue-50';
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¯Øª Ø­Ø¶ÙˆØ±
                let duration = '';
                if (record.checkInTime && record.checkOutTime) {
                    const checkIn = new Date(record.checkInTime);
                    const checkOut = new Date(record.checkOutTime);
                    const diff = checkOut - checkIn;
                    const hours = Math.floor(diff / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    duration = `${hours} Ø³Ø§Ø¹Øª Ùˆ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡`;
                }
                
                row.innerHTML = `
                    <td class="text-center">${index + 1}</td>
                    <td>${record.employeeCode}</td>
                    <td>${employee.fullName}</td>
                    <td>${formatJalaliDate(record.checkInTime)}</td>
                    <td>${formatTime(record.checkInTime)}</td>
                    <td>${formatTime(record.checkOutTime)}</td>
                    <td>${duration || '-'}</td>
                    <td>
                        ${record.checkOutTime ? 
                            '<span class="persian-badge badge-neutral">Ø®Ø±ÙˆØ¬</span>' : 
                            '<span class="persian-badge badge-success">Ø­Ø§Ø¶Ø±</span>'
                        }
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ø¬Ø¯ÙˆÙ„ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†
        function renderEmployeesTable() {
            const tableBody = document.getElementById('employeesTable');
            tableBody.innerHTML = '';
            
            const employeesList = Object.entries(employees);
            
            if (employeesList.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `<td colspan="7" class="py-4 text-center text-gray-500">Ù‡ÛŒÚ† Ú©Ø§Ø±Ù…Ù†Ø¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</td>`;
                tableBody.appendChild(emptyRow);
                return;
            }
            
            employeesList.forEach(([code, employee], index) => {
                const row = document.createElement('tr');
                row.className = 'table-row-animate hover:bg-blue-50';
                
                row.innerHTML = `
                    <td class="text-center">${index + 1}</td>
                    <td>${code}</td>
                    <td>${employee.fullName}</td>
                    <td>${employee.position || '-'}</td>
                    <td>${employee.department || '-'}</td>
                    <td>${formatJalaliDate(employee.registrationDate)}</td>
                    <td>
                        <button class="edit-employee bg-blue-500 hover:bg-blue-600 text-white py-1 px-2 rounded-md text-xs" data-code="${code}">ÙˆÛŒØ±Ø§ÛŒØ´</button>
                        <button class="delete-employee bg-red-500 hover:bg-red-600 text-white py-1 px-2 rounded-md text-xs" data-code="${code}">Ø­Ø°Ù</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ Ùˆ Ø­Ø°Ù
            document.querySelectorAll('.edit-employee').forEach(button => {
                button.addEventListener('click', function() {
                    const code = this.getAttribute('data-code');
                    editEmployee(code);
                });
            });
            
            document.querySelectorAll('.delete-employee').forEach(button => {
                button.addEventListener('click', function() {
                    const code = this.getAttribute('data-code');
                    deleteEmployee(code);
                });
            });
        }
        
        // ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ø§Ø±Ù…Ù†Ø¯
        function editEmployee(code) {
            const employee = employees[code];
            if (!employee) return;
            
            document.getElementById('employeeCodeInput').value = code;
            document.getElementById('employeeCodeInput').disabled = true;
            document.getElementById('fullName').value = employee.fullName;
            document.getElementById('position').value = employee.position || '';
            document.getElementById('department').value = employee.department || '';
            
            document.getElementById('registerModal').classList.remove('hidden');
        }
        
        // Ø­Ø°Ù Ú©Ø§Ø±Ù…Ù†Ø¯
        function deleteEmployee(code) {
            if (!confirm(`Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¨Ø§ Ú©Ø¯ ${code} Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ`)) return;
            
            delete employees[code];
            localStorage.setItem('employees', JSON.stringify(employees));
            
            // Ø­Ø°Ù Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨ Ù…Ø±ØªØ¨Ø·
            attendance = attendance.filter(record => record.employeeCode !== code);
            localStorage.setItem('attendance', JSON.stringify(attendance));
            
            renderEmployeesTable();
            renderAttendanceTable();
            
            alert('Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯.');
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¨Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ
        document.getElementById('employeeCode').addEventListener('input', function() {
            const code = this.value.trim();
            const employeeInfo = document.getElementById('employeeInfo');
            
            if (code && employees[code]) {
                const employee = employees[code];
                document.getElementById('infoFullName').textContent = employee.fullName;
                document.getElementById('infoPosition').textContent = employee.position || '-';
                document.getElementById('infoDepartment').textContent = employee.department || '-';
                employeeInfo.classList.remove('hidden');
            } else {
                employeeInfo.classList.add('hidden');
            }
        });
        
        // Ù†Ù…Ø§ÛŒØ´ Ù…Ø¯Ø§Ù„ Ø«Ø¨Øª Ù†Ø§Ù…
        function showRegisterModal() {
            const modal = document.getElementById('registerModal');
            modal.classList.remove('hidden');
            
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ùˆ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙØ±Ù…
            document.getElementById('employeeCodeInput').value = '';
            document.getElementById('employeeCodeInput').disabled = false;
            document.getElementById('fullName').value = '';
            document.getElementById('position').value = '';
            document.getElementById('department').value = '';
        }
        
        document.getElementById('registerBtn').addEventListener('click', showRegisterModal);
        document.getElementById('registerBtnTab').addEventListener('click', showRegisterModal);
        
        // Ø¨Ø³ØªÙ† Ù…Ø¯Ø§Ù„
        document.getElementById('closeRegisterModal').addEventListener('click', function() {
            document.getElementById('registerModal').classList.add('hidden');
        });
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¬Ø¯ÛŒØ¯
        document.getElementById('saveEmployeeBtn').addEventListener('click', function() {
            const employeeCode = document.getElementById('employeeCodeInput').value.trim();
            const fullName = document.getElementById('fullName').value.trim();
            const position = document.getElementById('position').value.trim();
            const department = document.getElementById('department').value;
            
            if (!employeeCode || employeeCode.length < 4) {
                alert('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ø­Ø¯Ø§Ù‚Ù„ 4 Ú©Ø§Ø±Ø§Ú©ØªØ±).');
                return;
            }
            
            if (!fullName) {
                alert('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ù†Ø¨ÙˆØ¯Ù† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø¯Ø± Ø­Ø§Ù„Øª Ø«Ø¨Øª Ø¬Ø¯ÛŒØ¯
            if (!document.getElementById('employeeCodeInput').disabled && employees[employeeCode]) {
                alert('Ø§ÛŒÙ† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ø¯ÛŒÚ¯Ø±ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ù…Ù†Ø¯
            employees[employeeCode] = {
                fullName,
                position,
                department,
                registrationDate: employees[employeeCode]?.registrationDate || new Date().toISOString()
            };
            
            localStorage.setItem('employees', JSON.stringify(employees));
            
            // Ø¨Ø³ØªÙ† Ù…Ø¯Ø§Ù„ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ÛŒØª
            document.getElementById('registerModal').classList.add('hidden');
            
            if (document.getElementById('employeeCodeInput').disabled) {
                alert(`Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¨Ø§ Ú©Ø¯ ${employeeCode} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯.`);
            } else {
                alert(`Ú©Ø§Ø±Ù…Ù†Ø¯ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ ${employeeCode} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯.`);
            }
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¬Ø¯Ø§ÙˆÙ„
            renderEmployeesTable();
        });
        
        // Ø«Ø¨Øª ÙˆØ±ÙˆØ¯
        document.getElementById('checkInBtn').addEventListener('click', function() {
            const employeeCode = document.getElementById('employeeCode').value.trim();
            
            if (!employeeCode) {
                alert('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            if (!employees[employeeCode]) {
                alert('Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¯Ù… Ø«Ø¨Øª ÙˆØ±ÙˆØ¯ Ù‚Ø¨Ù„ÛŒ Ø¯Ø± Ù‡Ù…Ø§Ù† Ø±ÙˆØ²
            const now = new Date();
            const today = formatJalaliDate(now);
            const existingRecord = attendance.find(record => 
                record.employeeCode === employeeCode && 
                formatJalaliDate(record.checkInTime) === today && 
                !record.checkOutTime
            );
            
            if (existingRecord) {
                alert('Ø´Ù…Ø§ Ù‚Ø¨Ù„Ø§Ù‹ ÙˆØ±ÙˆØ¯ Ø®ÙˆØ¯ Ø±Ø§ Ø«Ø¨Øª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯. Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ø®Ø±ÙˆØ¬ Ø±Ø§ Ø«Ø¨Øª Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            // Ø«Ø¨Øª Ø±Ú©ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯
            const newRecord = {
                id: Date.now().toString(),
                employeeCode,
                date: today,
                checkInTime: now.toISOString(),
                checkOutTime: null
            };
            
            attendance.unshift(newRecord);
            localStorage.setItem('attendance', JSON.stringify(attendance));
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¬Ø¯ÙˆÙ„
            renderAttendanceTable();
            document.getElementById('employeeCode').value = '';
            document.getElementById('employeeInfo').classList.add('hidden');
            
            alert('ÙˆØ±ÙˆØ¯ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯.');
        });
        
        // Ø«Ø¨Øª Ø®Ø±ÙˆØ¬
        document.getElementById('checkOutBtn').addEventListener('click', function() {
            const employeeCode = document.getElementById('employeeCode').value.trim();
            
            if (!employeeCode) {
                alert('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            if (!employees[employeeCode]) {
                alert('Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.');
                return;
            }
            
            // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø¢Ø®Ø±ÛŒÙ† Ø±Ú©ÙˆØ±Ø¯ ÙˆØ±ÙˆØ¯ Ø¨Ø¯ÙˆÙ† Ø®Ø±ÙˆØ¬
            const now = new Date();
            const today = formatJalaliDate(now);
            
            // Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø±Ø§ÛŒ Ø±Ú©ÙˆØ±Ø¯ ÙˆØ±ÙˆØ¯ Ø¨Ø¯ÙˆÙ† Ø®Ø±ÙˆØ¬
            let recordIndex = -1;
            for (let i = 0; i < attendance.length; i++) {
                if (attendance[i].employeeCode === employeeCode && 
                    !attendance[i].checkOutTime && 
                    formatJalaliDate(attendance[i].checkInTime) === today) {
                    recordIndex = i;
                    break;
                }
            }
            
            if (recordIndex === -1) {
                alert('Ø§Ø¨ØªØ¯Ø§ Ø¨Ø§ÛŒØ¯ ÙˆØ±ÙˆØ¯ Ø®ÙˆØ¯ Ø±Ø§ Ø«Ø¨Øª Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            // Ø«Ø¨Øª Ø²Ù…Ø§Ù† Ø®Ø±ÙˆØ¬
            attendance[recordIndex].checkOutTime = now.toISOString();
            localStorage.setItem('attendance', JSON.stringify(attendance));
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¬Ø¯ÙˆÙ„
            renderAttendanceTable();
            document.getElementById('employeeCode').value = '';
            document.getElementById('employeeInfo').classList.add('hidden');
            
            alert('Ø®Ø±ÙˆØ¬ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯.');
        });
        
        // ØªØºÛŒÛŒØ± ØªØ¨â€ŒÙ‡Ø§
        document.getElementById('attendanceTabBtn').addEventListener('click', function() {
            document.getElementById('attendanceTab').classList.remove('hidden');
            document.getElementById('employeesTab').classList.add('hidden');
            document.getElementById('attendanceTabBtn').classList.add('tab-active');
            document.getElementById('employeesTabBtn').classList.remove('tab-active');
        });
        
        document.getElementById('employeesTabBtn').addEventListener('click', function() {
            document.getElementById('attendanceTab').classList.add('hidden');
            document.getElementById('employeesTab').classList.remove('hidden');
            document.getElementById('attendanceTabBtn').classList.remove('tab-active');
            document.getElementById('employeesTabBtn').classList.add('tab-active');
            renderEmployeesTable();
        });
        
        // Ù†Ù…Ø§ÛŒØ´ Ø§ÙˆÙ„ÛŒÙ‡ Ø¬Ø¯ÙˆÙ„
        renderAttendanceTable();
        
        // Ø¨Ø³ØªÙ† Ù…Ø¯Ø§Ù„ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø®Ø§Ø±Ø¬ Ø§Ø² Ø¢Ù†
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('registerModal');
            if (event.target === modal) {
                modal.classList.add('hidden');
            }
        });
        
        // ØªÙˆØ§Ø¨Ø¹ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ†
        
        // Ø®Ø±ÙˆØ¬ÛŒ JSON
        function exportToJson(data, filename) {
            const jsonStr = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„
        function exportToExcel(data, sheetName, filename) {
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, sheetName);
            XLSX.writeFile(wb, filename);
        }
        
        // Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ
        function prepareAttendanceData() {
            return attendance.map(record => {
                const employee = employees[record.employeeCode] || { fullName: 'Ù†Ø§Ù…Ø´Ø®Øµ' };
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¯Øª Ø­Ø¶ÙˆØ±
                let duration = '';
                if (record.checkInTime && record.checkOutTime) {
                    const checkIn = new Date(record.checkInTime);
                    const checkOut = new Date(record.checkOutTime);
                    const diff = checkOut - checkIn;
                    const hours = Math.floor(diff / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    duration = `${hours} Ø³Ø§Ø¹Øª Ùˆ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡`;
                }
                
                return {
                    'Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ': record.employeeCode,
                    'Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ': employee.fullName,
                    'ØªØ§Ø±ÛŒØ®': formatJalaliDate(record.checkInTime),
                    'Ø²Ù…Ø§Ù† ÙˆØ±ÙˆØ¯': formatTime(record.checkInTime),
                    'Ø²Ù…Ø§Ù† Ø®Ø±ÙˆØ¬': formatTime(record.checkOutTime),
                    'Ù…Ø¯Øª Ø­Ø¶ÙˆØ±': duration || '-',
                    'ÙˆØ¶Ø¹ÛŒØª': record.checkOutTime ? 'Ø®Ø±ÙˆØ¬' : 'Ø­Ø§Ø¶Ø±'
                };
            });
        }
        
        // Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù† Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ
        function prepareEmployeesData() {
            return Object.entries(employees).map(([code, employee]) => {
                return {
                    'Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ': code,
                    'Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ': employee.fullName,
                    'Ø³Ù…Øª': employee.position || '-',
                    'Ø¨Ø®Ø´': employee.department || '-',
                    'ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª Ù†Ø§Ù…': formatJalaliDate(employee.registrationDate)
                };
            });
        }
        
        // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ
        document.getElementById('exportAttendanceJson').addEventListener('click', function() {
            const data = prepareAttendanceData();
            if (data.length === 0) {
                alert('Ù‡ÛŒÚ† Ø±Ú©ÙˆØ±Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }
            exportToJson(data, 'attendance_records.json');
        });
        
        document.getElementById('exportAttendanceExcel').addEventListener('click', function() {
            const data = prepareAttendanceData();
            if (data.length === 0) {
                alert('Ù‡ÛŒÚ† Ø±Ú©ÙˆØ±Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }
            exportToExcel(data, 'Ø­Ø¶ÙˆØ± Ùˆ ØºÛŒØ§Ø¨', 'attendance_records.xlsx');
        });
        
        document.getElementById('exportEmployeesJson').addEventListener('click', function() {
            const data = prepareEmployeesData();
            if (data.length === 0) {
                alert('Ù‡ÛŒÚ† Ú©Ø§Ø±Ù…Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }
            exportToJson(data, 'employees_data.json');
        });
        
        document.getElementById('exportEmployeesExcel').addEventListener('click', function() {
            const data = prepareEmployeesData();
            if (data.length === 0) {
                alert('Ù‡ÛŒÚ† Ú©Ø§Ø±Ù…Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }
            exportToExcel(data, 'Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†', 'employees_data.xlsx');
        });
        
        // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ø¯Ø± ØªØ¨ Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†
        document.getElementById('exportEmployeesJsonTab').addEventListener('click', function() {
            const data = prepareEmployeesData();
            if (data.length === 0) {
                alert('Ù‡ÛŒÚ† Ú©Ø§Ø±Ù…Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }
            exportToJson(data, 'employees_data.json');
        });
        
        document.getElementById('exportEmployeesExcelTab').addEventListener('click', function() {
            const data = prepareEmployeesData();
            if (data.length === 0) {
                alert('Ù‡ÛŒÚ† Ú©Ø§Ø±Ù…Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
                return;
            }
            exportToExcel(data, 'Ú©Ø§Ø±Ù…Ù†Ø¯Ø§Ù†', 'employees_data.xlsx');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93f3186ea4b1b6a1',t:'MTc0NzE0OTE2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>